sap.ui.define(["sap/m/MessageToast","sap/m/Dialog","sap/m/Button","sap/ui/unified/FileUploader","sap/ui/model/json/JSONModel","sap/m/Text"],function(e,t,o,a,s,n){"use strict";const i={sendDataToService:function(t){const o=new sap.ui.model.odata.v4.ODataModel({serviceUrl:"/odata/v4/catalog/"});const a=o.bindList("/Materials");const s=[];t.forEach(e=>{const t=a.create(e,true);s.push(t)});o.submitBatch("batchGroupId").then(()=>{e.show("Data uploaded successfully.")}).catch(t=>{e.show("Error uploading data: "+t.message)})},handleUpload:function(){const e=e=>{const t=e.getSource();const o=t.oFileUpload.files[0];if(o){const e=new FileReader;e.onload=e=>{const t=e.target.result;const o=XLSX.read(t,{type:"binary"});const a=o.Sheets[o.SheetNames[0]];const n=XLSX.utils.sheet_to_json(a);i.sendDataToService(n);s.close()};e.readAsBinaryString(o)}};const s=new t({title:"Upload Confirmation",type:"Message",content:[new n({text:"Do you want to proceed with the upload?"}),new a({id:"fileUploader",uploadUrl:"/odata/v4/catalog/Materials",name:"uploadFile",change:e,visible:true})],beginButton:new o({text:"Yes",press:function(){const e=sap.ui.getCore().byId("fileUploader");e.setVisible(true);e.focus()}}),endButton:new o({text:"No",press:function(){s.close()}}),afterClose:function(){s.destroy()}});s.open()}};return i});